install.packages("miktex")
install.packages("installr")
library(installr)
updateR()
install.packages("xm12")
library(xm12)
library("xm12")
library(xm12)
install.packages("xml2")
library(xml2)
webpage_url <- "https://supportyoursport.migros.ch/de/rangliste/gruppe-c/"
webpage <- sml2::read_html(webpage_url)
webpage <- xml2::read_html(webpage_url)
ExOffndrsRaw <- rvest::html_table(webpage)[[1]] %>%
tibble::as_tibble(.name_repair = "unique") # repair the repeated columns
library(rvest)
library(tibble)
ExOffndrsRaw <- rvest::html_table(webpage)[[1]] %>%
tibble::as_tibble(.name_repair = "unique") # repair the repeated columns
setwd("C:/Users/p_lae/OneDrive - Universit채t Z체rich UZH/Dokumente/Universit채t Z체rich/12. Semester/Empirical Finance/EmpiricalFinance/Assignment 1")
# load libraries
library(xts)
library(PerformanceAnalytics)
library(psych)
###############
# Data import #
###############
prices <- read.delim(file = 'A1_dataset_01.txt', header = TRUE, sep = '\t', dec = '.')
returns <- read.delim(file = 'A1_dataset_02.txt', header = TRUE, sep = '\t', dec = '.')
interest_rates <- read.delim(file = 'A1_dataset_03.txt', header = TRUE, sep = '\t', dec = '.')
market_values <- read.delim(file = 'A1_dataset_04.txt', header = TRUE, sep = '\t', dec = '.')
cpi <- read.delim(file = 'A1_dataset_05.txt', header = TRUE, sep = '\t', dec = '.')
date <- as.Date(prices[,1])
prices.ts <- xts(x = prices[,-1], order.by = date)
returns_results <- Return.calculate(prices = prices.ts, method = 'discrete')
# ii)
portfolio_EW_returns <- rowMeans(returns_results, na.rm=TRUE)
portfolio_EW_returnsts <- xts(portfolio_EW_returns, order.by = date)
portfolio_EW <- portfolio_EW_returnsts[-1,]
mean_return_EW <- mean(portfolio_EW)
pf_annualized_EW <- (((1+mean_return_EW)^12)-1)
MC_monthly <- xts(x = market_values[,-1], order.by = date)
# Create a vector of the total market cap of the index for a given month
totMC_monthly <- rowSums(MC_monthly, na.rm = TRUE)
#Compute weights
VW_weights <- MC_monthly / totMC_monthly
#Lag marketcap
lag_VW_weights <- lag.xts(VW_weights, 1)
#Now we multiply the weights by the returns
vw_returns <- lag_VW_weights * returns_results
#Now we sum this across all stock to get the portfolio return
portfolio_VW_returns <- rowSums(vw_returns, na.rm = TRUE)
portfolio_VW_returnsts <- xts(portfolio_VW_returns, order.by = date)
#Drop the first row since that should be missing
portfolio_VW <- portfolio_VW_returnsts[-1,]
mean_return_VW <- mean(portfolio_VW)
pf_annualized_VW <- (((1+mean_return_VW)^12)-1)
test <- 1+portfolio_EW
View(test)
rm(test)
?lag
?prod
test <- c(0,1,2,3,4,5,6,7,8,9)
test$one <- c(0,1,2,3,4,5,6,7,8,9)
test$one <- dataframe[,c(0,1,2,3,4,5,6,7,8,9)]
test$one <- data.table::[,c(0,1,2,3,4,5,6,7,8,9)]
test <- data.frame(c(0,1,2,3,4,5,6,7,8,9))
View(test)
test <- data.table(c(0,1,2,3,4,5,6,7,8,9))
colnames(test) <- "one"
View(test)
test$two <- rollaplyr(1+test$one, na.rm=T,2, prod, fill=NA)
?rollapplyr
library(zoo)
test$two <- rollaplyr(1+test$one, na.rm=T,2, prod, fill=NA)
test$two <- rollapplyr(1+test$one, na.rm=T,2, prod, fill=NA)
View(test)
test$two <- rollapplyr(1+test$one, na.rm=T,3, prod, fill=NA)
# calculate 24, 36 and 48 months return
portfolio_EW_24 <- rollapplyr(1+portfolio_EW, na.rm=T, 24, prod, fill=NA)
View(portfolio_EW_24)
test$two <- rollapplyr(1+test$one, na.rm=T,3, prod-1, fill=NA)
# calculate 12, 24, 36 and 48 months return (+1)
portfolio_EW_12 <- rollapplyr(1+portfolio_EW, na.rm=T, 12, prod, fill=NA)
portfolio_EW_24 <- rollapplyr(1+portfolio_EW, na.rm=T, 24, prod, fill=NA)
portfolio_EW_36 <- rollapplyr(1+portfolio_EW, na.rm=T, 36, prod, fill=NA)
portfolio_EW_48 <- rollapplyr(1+portfolio_EW, na.rm=T, 48, prod, fill=NA)
prod(portfolio_EW_12)
var(portfolio_EW_12)
prod(portfolio_EW_12,na.rm=T)
prod(portfolio_EW_12-1,na.rm=T)
prod(test$one-1)
prod(test$one-)
prod(test$one)
prod(test$two)
prod(test$two,na.rm=T)
prod(test$two-1,na.rm=T)
var(portfolio_EW_12,na.rm = T)
var(portfolio_EW_12-1,na.rm = T)
# calculate variance ratios
VR_EW_1 <- (var(portfolio_EW)/var(portfolio_EW_12-1))*(12/1)
# calculate variance ratios
VR_EW_1 <- (var(portfolio_EW)/var(portfolio_EW_12-1,na.rm=T))*(12/1)
VR_EW_24 <- (var(portfolio_EW)/var(portfolio_EW_24-1,na.rm=T))*(12/24)
VR_EW_36 <- (var(portfolio_EW)/var(portfolio_EW_36-1,na.rm=T))*(12/36)
View(portfolio_EW)
View(portfolio_EW_12)
View(portfolio_EW_24)
View(portfolio_EW_36)
View(portfolio_EW_48)
VR_EW_24 <- (var(portfolio_EW_24)/var(portfolio_EW_12-1,na.rm=T))*(12/24)
VR_EW_36 <- (var(portfolio_EW_36)/var(portfolio_EW_12-1,na.rm=T))*(12/36)
VR_EW_48 <- (var(portfolio_EW_48)/var(portfolio_EW_12-1,na.rm=T))*(12/48)
VR_EW_24 <- (var(portfolio_EW_24,na.rm=T)/var(portfolio_EW_12-1,na.rm=T))*(12/24)
VR_EW_36 <- (var(portfolio_EW_36,na.rm=T)/var(portfolio_EW_12-1,na.rm=T))*(12/36)
VR_EW_48 <- (var(portfolio_EW_48,na.rm=T)/var(portfolio_EW_12-1,na.rm=T))*(12/48)
sd_portfolio_EW_12<- (mean(rollapplyr(portfolio_EW,na.rm=TRUE,12,sd,fill=NA),na.rm=TRUE)*12^0.5)
var_portfolio_EW_12<- (mean(rollapplyr(portfolio_EW,na.rm=TRUE,12,sd,fill=NA),na.rm=TRUE)*12^0.5)^2
var_portfolio_EW_1<- var(portfolio_EW,na.rm=TRUE)
VR_EW_1=(var_portfolio_EW_1/1)/(var_portfolio_EW_12/12)
var_portfolio_EW_24<- (mean(rollapplyr(portfolio_EW,na.rm=TRUE,24,sd,fill=NA),na.rm=TRUE)*24^0.5)^2
VR_EW_24=(var_portfolio_EW_24/24)/(var_portfolio_EW_12/12)
var_portfolio_EW_36<- (mean(rollapplyr(portfolio_EW,na.rm=TRUE,36,sd,fill=NA),na.rm=TRUE)*36^0.5)^2
VR_EW_36=(var_portfolio_EW_36/36)/(var_portfolio_EW_12/12)
var_portfolio_EW_48<- (mean(rollapplyr(portfolio_EW,na.rm=TRUE,48,sd,fill=NA),na.rm=TRUE)*48^0.5)^2
VR_EW_48=(var_portfolio_EW_48/48)/(var_portfolio_EW_12/12)
# calculate variance ratios
VR_EW_1 <- (var(portfolio_EW)/var(portfolio_EW_12-1,na.rm=T))*(12/1)
sd_portfolio_EW_12<- (mean(rollapplyr(portfolio_EW_returnsts,na.rm=TRUE,12,sd,fill=NA),na.rm=TRUE)*12^0.5)
var_portfolio_EW_12<- (mean(rollapplyr(portfolio_EW_returnsts,na.rm=TRUE,12,sd,fill=NA),na.rm=TRUE)*12^0.5)^2
var_portfolio_EW_1<- var(portfolio_EW_returnsts,na.rm=TRUE)
VR_EW_1=(var_portfolio_EW_1/1)/(var_portfolio_EW_12/12)
var_portfolio_EW_24<- (mean(rollapplyr(portfolio_EW_returnsts,na.rm=TRUE,24,sd,fill=NA),na.rm=TRUE)*24^0.5)^2
VR_EW_24=(var_portfolio_EW_24/24)/(var_portfolio_EW_12/12)
var_portfolio_EW_36<- (mean(rollapplyr(portfolio_EW_returnsts,na.rm=TRUE,36,sd,fill=NA),na.rm=TRUE)*36^0.5)^2
VR_EW_36=(var_portfolio_EW_36/36)/(var_portfolio_EW_12/12)
var_portfolio_EW_48<- (mean(rollapplyr(portfolio_EW_returnsts,na.rm=TRUE,48,sd,fill=NA),na.rm=TRUE)*48^0.5)^2
VR_EW_48=(var_portfolio_EW_48/48)/(var_portfolio_EW_12/12)
VR_EW_1 <- (var(portfolio_EW)/var(portfolio_EW_12-1,na.rm=T))*(12/1)
VR_EW_24 <- (var(portfolio_EW_24,na.rm=T)/var(portfolio_EW_12-1,na.rm=T))*(12/24)
VR_EW_36 <- (var(portfolio_EW_36,na.rm=T)/var(portfolio_EW_12-1,na.rm=T))*(12/36)
VR_EW_48 <- (var(portfolio_EW_48,na.rm=T)/var(portfolio_EW_12-1,na.rm=T))*(12/48)
VR_EW_1=(var_portfolio_EW_1/1)/(var_portfolio_EW_12/12)
# calculate variance ratios
VR_EW_1 <- (var(portfolio_EW)/var(pf_EW_12-1,na.rm=T))*(12/1)
# calculate 12, 24, 36 and 48 months return (+1)
pf_EW_12 <- rollapplyr(1+portfolio_EW, na.rm=T, 12, prod, fill=NA)
pf_EW_24 <- rollapplyr(1+portfolio_EW, na.rm=T, 24, prod, fill=NA)
pf_EW_36 <- rollapplyr(1+portfolio_EW, na.rm=T, 36, prod, fill=NA)
pf_EW_48 <- rollapplyr(1+portfolio_EW, na.rm=T, 48, prod, fill=NA)
# calculate variance ratios
VR_EW_1 <- (var(portfolio_EW)/var(pf_EW_12-1,na.rm=T))*(12/1)
View(portfolio_EW_returnsts)
var(pf_EW_24,na.rm=T)
var(pf_EW_36,na.rm=T)
var(pf_EW_48,na.rm=T)
var(portfolio_EW)
View(portfolio_EW_12)
View(prices[,1])
View(prices)
View(prices.ts)
mean(pf_EW_12-1,na.rm=T)
VR_EW_24 <- (var(pf_EW_24-1,na.rm=T)/var(pf_EW_12-1,na.rm=T))*(12/24)
VR_EW_36 <- (var(pf_EW_36-1,na.rm=T)/var(pf_EW_12-1,na.rm=T))*(12/36)
VR_EW_48 <- (var(pf_EW_48-1,na.rm=T)/var(pf_EW_12-1,na.rm=T))*(12/48)
# calculate annualized standard deviation for equal and value weighted returns
pf_annualized_std_EW <- sd(portfolio_EW)*sqrt(12)
pf_annualized_std_VW <- sd(portfolio_VW)*sqrt(12)
sd_portfolio_EW_12<- (mean(rollapplyr(portfolio_EW_returnsts,na.rm=TRUE,12,sd,fill=NA),na.rm=TRUE)*12^0.5)
# calculate variance ratios
VR_EW_1 <- (var(portfolio_EW)/1)*(var(pf_EW_12-1,na.rm=T)/12)
# calculate variance ratios
VR_EW_1 <- (var(portfolio_EW)/1)/(var(pf_EW_12-1,na.rm=T)/12)
# calculate log returns and repeat ii)
log_portfolio_EW <- log(portfolio_EW+1)
pf_VW_12 <- rollapplyr(1+portfolio_VW, na.rm=T, 12, prod, fill=NA)
pf_VW_24 <- rollapplyr(1+portfolio_VW, na.rm=T, 24, prod, fill=NA)
pf_VW_36 <- rollapplyr(1+portfolio_VW, na.rm=T, 36, prod, fill=NA)
pf_VW_48 <- rollapplyr(1+portfolio_VW, na.rm=T, 48, prod, fill=NA)
VR_VW_1 <- (var(portfolio_VW)/var(pf_VW_12-1,na.rm=T))*(12/1)
VR_VW_24 <- (var(pf_VW_24-1,na.rm=T)/var(pf_VW_12-1,na.rm=T))*(12/24)
VR_VW_36 <- (var(pf_VW_36-1,na.rm=T)/var(pf_VW_12-1,na.rm=T))*(12/36)
VR_VW_48 <- (var(pf_VW_48-1,na.rm=T)/var(pf_VW_12-1,na.rm=T))*(12/48)
# calculate annualized standard deviation for equal and value weighted returns
log_pf_annualized_std_EW <- sd(log_portfolio_EW)*sqrt(12)
log_pf_annualized_std_VW <- sd(log_portfolio_VW)*sqrt(12)
log_portfolio_VW <- log(portfolio_VW+1)
log_pf_annualized_std_VW <- sd(log_portfolio_VW)*sqrt(12)
log_pf_EW_12 <- rollapplyr(1+log_portfolio_EW, na.rm=T, 12, prod, fill=NA)
log_pf_EW_24 <- rollapplyr(1+log_portfolio_EW, na.rm=T, 24, prod, fill=NA)
log_pf_EW_36 <- rollapplyr(1+log_portfolio_EW, na.rm=T, 36, prod, fill=NA)
log_pf_EW_48 <- rollapplyr(1+log_portfolio_EW, na.rm=T, 48, prod, fill=NA)
# calculate variance ratios
log_VR_EW_1 <- (var(log_portfolio_EW)/var(log_pf_EW_12-1,na.rm=T))*(12/1)
log_VR_EW_24 <- (var(log_pf_EW_24-1,na.rm=T)/var(log_pf_EW_12-1,na.rm=T))*(12/24)
log_VR_EW_36 <- (var(log_pf_EW_36-1,na.rm=T)/var(log_pf_EW_12-1,na.rm=T))*(12/36)
log_VR_EW_48 <- (var(log_pf_EW_48-1,na.rm=T)/var(log_pf_EW_12-1,na.rm=T))*(12/48)
log_pf_VW_12 <- rollapplyr(1+log_portfolio_VW, na.rm=T, 12, prod, fill=NA)
log_pf_VW_24 <- rollapplyr(1+log_portfolio_VW, na.rm=T, 24, prod, fill=NA)
log_pf_VW_36 <- rollapplyr(1+log_portfolio_VW, na.rm=T, 36, prod, fill=NA)
log_pf_VW_48 <- rollapplyr(1+log_portfolio_VW, na.rm=T, 48, prod, fill=NA)
# calculate variance ratios
log_VR_EW_1 <- (var(log_portfolio_EW)/var(log_pf_EW_12-1,na.rm=T))*(12/1)
log_VR_EW_24 <- (var(log_pf_EW_24-1,na.rm=T)/var(log_pf_EW_12-1,na.rm=T))*(12/24)
log_VR_EW_36 <- (var(log_pf_EW_36-1,na.rm=T)/var(log_pf_EW_12-1,na.rm=T))*(12/36)
log_VR_EW_48 <- (var(log_pf_EW_48-1,na.rm=T)/var(log_pf_EW_12-1,na.rm=T))*(12/48)
log_VR_VW_1 <- (var(log_portfolio_VW)/var(log_pf_VW_12-1,na.rm=T))*(12/1)
log_VR_VW_24 <- (var(log_pf_VW_24-1,na.rm=T)/var(log_pf_VW_12-1,na.rm=T))*(12/24)
log_VR_VW_36 <- (var(log_pf_VW_36-1,na.rm=T)/var(log_pf_VW_12-1,na.rm=T))*(12/36)
log_VR_VW_48 <- (var(log_pf_VW_48-1,na.rm=T)/var(log_pf_VW_12-1,na.rm=T))*(12/48)
