portfolio_S <- subset(market_cap, market_cap[i,] < x )
}
#2.
#View(market_cap)
for (i in 1:361){
x <- rowMedians(market_cap[1:i], na.rm = TRUE)
}
x <- as.vector(rowMedians(market_cap[1:i], na.rm = TRUE))
print(x)
x <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
View(x)
market_cap$median_cap <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
x <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
medians <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
#2.
#View(market_cap)
for (i in 1:361){
medians <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
}
View(medians)
market_cap_new <- cbind(market_cap, medians)
median <- rowMedians(market_cap[1,])
median <- rowMedians(market_cap[1,], na.rm = TRUE)
portfolio_S <- as.data.frame(subset(market_cap, mean_market_cap[1,] < median))
portfolio_S
View(portfolio_S)
portfolio_S <- as.data.frame(subset(market_cap, mean_market_cap[1,] < median))
View(portfolio_S)
portfolio_S <- as.data.frame(subset(market_cap, mean_market_cap[1,] > median))
portfolio_S <- as.data.frame(subset(market_cap, mean_market_cap[1,] < median))
median <- rowMedians(market_cap[1,], na.rm = TRUE)
portfolio_S <- as.data.frame(subset(market_cap, mean_market_cap[1,1:384] < median))
portfolio_S <- as.data.frame(subset(market_cap, mean_market_cap[1, (1:384)] < median))
portfolio_S <- as.data.frame(subset(market_cap, market_cap[1,(1:384)] < median))
portfolio_S <- as.data.frame(subset(market_cap, market_cap[1,1:384] < median))
portfolio_S <- as.data.frame(subset(market_cap, market_cap[1, c(1:384)] < median))
#2.
#View(market_cap)
for (i in 1:361){
market_cap$medians <- rowMedians(market_cap[1:i], na.rm = TRUE)
}
(
#2.
#View(market_cap)
for (i in 1:361){
medians <- (rowMedians(market_cap[1:i], na.rm = TRUE))
}
medians <- as.data.frame.array(rowMedians(market_cap[1:i], na.rm = TRUE))
#2.
#View(market_cap)
for (i in 1:361){
medians <- as.data.frame.array(rowMedians(market_cap[1:i], na.rm = TRUE))
}
#2.
#View(market_cap)
for (i in 1:361){
medians <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
}
View(medians)
market_cap_new <- cbind(market_cap, medians)
as.numeric(medians)
as.numeric(medians)
#2.
#View(market_cap)
for (i in 1:361){
medians <- rowMedians(market_cap[1:i], na.rm = TRUE)
}
as.numeric(medians)
medians <- as.vector(as.numeric(medians))
market_cap_new <- cbind(market_cap, medians)
View(market_cap_new)
market_cap_new <- cbind(market_cap, medians)
View(market_cap_new)
medians <- as.vector(as.numeric(medians))
market_cap_new <- cbind(market_cap, medians)
View(market_cap_new)
prices_adjusted <- A4_dataset_01
book_values <- A4_dataset_02
shares <- A4_dataset_03
prices_unadjusted <- A4_dataset_04
riskfree <-A4_dataset_05
factor_returns <- A4_dataset_06
for (i in 1:384){
market_cap <- prices_unadjusted[,2:i]*shares[,2:i]
}
# # create monthly returns for stocks and SMI
prices_adjusted <- xts(prices_adjusted[,-1], order.by = as.Date(prices_adjusted $Date, format = "%d.%m.%Y"))
book_values <- xts(book_values[,-1], order.by = as.Date(book_values$Date, format = "%d.%m.%Y"))
shares <- xts(shares[,-1], order.by = as.Date(shares$Date, format = "%d.%m.%Y"))
prices_unadjusted <- xts(prices_unadjusted[,-1], order.by = as.Date(prices_unadjusted$Date, format = "%d.%m.%Y"))
riskfree <- xts(riskfree[,-1], order.by = as.Date(riskfree$Date, format = "%d.%m.%Y"))
factor_returns <- xts(factor_returns[,-1], order.by = as.Date(factor_returns$Date, format = "%d.%m.%Y"))
for (i in 1:384){
market_cap <- prices_unadjusted[,1:i]*shares[,1:i]
}
#2.
#View(market_cap)
for (i in 1:361){
medians <- rowMedians(market_cap[1:i], na.rm = TRUE)
}
values = seq(from = as.Date("1989-12-01"), to = as.Date("2019-12-01"), by = 'month')
medians.ts <- merge(medians), values, all = T)
medians.ts <- merge(medians, values, all = T)
View(medians.ts)
medians.ts <- xts(medians.ts[,-1], order.by = as.Date(medians.ts$y, format = "%d.%m.%Y"))
View(medians.ts)
medians.ts <- merge(medians, values, all = T)
medians.ts$ <-
colnames(medians.ts) <- c("Median_CAP", "Date")
View(medians.ts)
medians.ts <- xts(medians.ts[,-1], order.by = as.Date(medians.ts$Date, format = "%Y.%m.%d"))
medians.ts <- merge(medians, values, all = T)
medians.ts$ <-
colnames(medians.ts) <- c("Median_CAP", "Date")
medians.ts <- xts(medians.ts[,-2], order.by = as.Date(medians.ts$Date, format = "%Y.%m.%d"))
medians.ts <- xts(medians.ts, order.by = as.Date(medians.ts$Date, format = "%Y.%m.%d"))
medians.ts <- merge(medians, values, all = T)
View(medians.ts)
medians.ts$ <-
colnames(medians.ts) <- c("Median_CAP", "Date")
medians.ts <- xts(medians.ts, order.by = as.Date(medians.ts$Date, format = "%Y.%m.%d"))
medians.ts <- xts(medians.ts[,-1], order.by = as.Date(medians.ts$Date, format = "%Y.%m.%d"))
medians.ts <- merge(medians, values, all = T)
medians.ts$ <-
colnames(medians.ts) <- c("Median_CAP", "Date")
values = seq(from = as.Date("01-12-1989"), to = as.Date("01-12-2019"), by = 'month')
medians.ts <- merge(medians, values, all = T)
View(medians.ts)
medians.ts$ <-
colnames(medians.ts) <- c("Median_CAP", "Date")
market_cap$Median_CAP <- medians.ts$Median_CAP
View(market_cap_new)
View(market_cap)
#2.
#View(market_cap)
for (i in 1:361){
medians <- rowMedians(market_cap[1:i], na.rm = TRUE)
}
medians.ts$Median_CAP <- as.data.frame(medians)
market_cap$Median_CAP <- medians.ts$Median_CAP
for (i in 1:384){
market_cap <- prices_unadjusted[,1:i]*shares[,1:i]
}
#2.
#View(market_cap)
for (i in 1:361){
medians <- rowMedians(market_cap[1:i], na.rm = TRUE)
}
medians.ts$Median_CAP <- as.data.frame(medians)
market_cap$Median_CAP <- medians.ts$Median_CAP
View(market_cap)
View(market_cap)
medians.ts$Median_CAP <- as.data.frame(medians)
medians.ts <- as.data.frame(medians)
#2.
#View(market_cap)
for (i in 1:361){
medians <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
}
View(medians)
#2.
#View(market_cap)
for (i in 1:361){
medians <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
}
View(medians)
medians$Median_CAP <- medians[,1]
View(medians)
market_cap$Median_CAP <- medians$Median_CAP
View(market_cap)
for (i in 1:384){
market_cap <- prices_unadjusted[,1:i]*shares[,1:i]
}
#2.
#View(market_cap)
for (i in 1:361){
medians <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
}
medians$Median_CAP <- medians[,1]
market_cap$Median_CAP <- medians$Median_CAP
View(market_cap)
for (i in 1:384) {
median <- market_cap[1,385], na.rm = TRUE)
median <- market_cap[1,385]
View(median)
portfolio_S <- as.data.frame(subset(market_cap, market_cap[1, (1:384)] < market_cap[1, 385]))
row_1 <- subset(market_cap[1,])
View(row_1)
portfolio_S <- as.data.frame(subset(row_1, [,1:384] < row_1, [,385]))
portfolio_S <- as.data.frame(subset(row_1, row_1[,1:384] < row_1, [,385]))
portfolio_S <- as.data.frame(subset(row_1, row_1[,1:384] < row_1 [,385]))
for (i in 1:384){
book_to_market <- book_values[,1:i]/market_cap[,1:i]
}
lagges_book_values <- lag(book_values, k=6)
for (i in 1:384){
book_to_market <- lagges_book_values[,1:i]/market_cap[,1:i]
}
View(book_to_market)
View(book_values)
19873000
13936000/18645550
13936000/20691300
#2.
#View(market_cap)
for (i in 1:361){
medians <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
}
View(medians)
medians$Median_CAP <- medians[,1]
View(medians)
market_cap$Median_CAP <- medians$Median_CAP
View(market_cap)
median <- market_cap[1,385]
#for one row:
row_1 <- subset(market_cap[1,])
for (i in 1:384) {
if(row_1[,i] > medians[1,]){row_1[,i] <- NULL}
}
View(market_cap)
portfolio_S <- as.data.frame(subset(market_cap, market_cap[1, (1:384)] < market_cap$Median_CAP))
portfolio_S <- as.data.frame(subset(market_cap, market_cap[1, (1:384)] < market_cap$Median_CAP[1,]))
for (i in 1:384){
market_cap <- prices_unadjusted[,1:i]*shares[,1:i]
}
market_cap$Median_CAP <- medians[,1]
#2.
#View(market_cap)
for (i in 1:361){
medians <- as.data.frame(rowMedians(market_cap[1:i], na.rm = TRUE))
}
market_cap$Median_CAP <- medians[,1]
View(market_cap)
portfolio_B <- market_cap
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
if(market_cap[i,ncol(market_cap)] < market_cap[i,j]) {
portfolio_B[i,j] <- 1
}
else {
portfolio_B[i,j] <- NA
}
}
}
print(nrow(market_cap))
print(ncol(market_cap))
print(market_cap[100,100])
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
if(market_cap[i,ncol(market_cap)] < market_cap[i,j]) {
portfolio_B[i,j] <- 1
}
else {
portfolio_B[i,j] <- 0
}
}
}
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(is.na(condition)) {
portfolio_B[i,j] <- 0
}
else if(condition) {
portfolio_B[i,j] <- 1
}
else {
portfolio_B[i,j] <- 0
}
}
}
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_B[i,j] <- 1
}
}
}
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
print(condition)
# if(!is.na(condition) && condition) {
#   portfolio_B[i,j] <- 1
# }
}
}
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
print(is.na(condition))
# if(!is.na(condition) && condition) {
#   portfolio_B[i,j] <- 1
# }
}
}
portfolio_B[0,0] <- 1
print(portfolio_B[0,0])
portfolio_B <- market_cap
print(market_cap[100,100])
portfolio_B[0,0] <- 1
print(portfolio_B[0,0])
portfolio_B[1,1] <- 1
print(portfolio_B[1,1])
portfolio_B <- market_cap
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_B[i,j] <- 1
}
}
}
View(portfolio_B)
portfolio_B <- market_cap
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_B[i,j] <- 1
}
}
}
portfolio_S <- market_cap
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] >= market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_S[i,j] <- 1
}
}
}
View(portfolio_S)
portfolio_B <- market_cap
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_B[i,j] <- 1
}
else {
portfolio_B[i,j] <- NA
}
}
}
portfolio_S <- market_cap
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] >= market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_S[i,j] <- 1
}
else {
portfolio_S[i,j] <- NA
}
}
}
rowSums(portfolio_S)
rowSums(portfolio_S, na.rm = T)
rowSums(portfolio_B, na.rm = T)
returns <- Return.calculate(prices = prices_adjusted, method = 'log')
lagged_book_values <- lag(book_values, k=6)
for (i in 1:384){
book_to_market <- lagged_book_values[,1:i]/market_cap[,1:i]
}
#3.
lag_portfolio_S <- lag(portfolio_S, k=1)
lag_portfolio_B <- lag(portfolio_B, k=1)
View(portfolio_B)
View(lag_portfolio_B)
#Calculate mean returns
for (i in 1:384){
returns_S <- prices_adjusted[,1:i]*lag_portfolio_S[,1:i]
}
returns_S_alternative <- prices_adjusted*lag_portfolio_S
View(returns_S)
View(returns)
#Calculate mean returns
for (i in 1:384){
returns_S <- returns[,1:i]*lag_portfolio_S[,1:i]
}
View(returns_S)
#Calculate mean returns for B
for (i in 1:384){
returns_B <- returns[,1:i]*lag_portfolio_B[,1:i]
}
View(returns_B)
returns_SMB <- returns_S - returns_B
View(returns_SMB)
print(condition)
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_B[i,j] <- 1
}
if(condition=FALSE){
portfolio_B[i,j] <- 0
}
else {
portfolio_B[i,j] <- NA
}
}
}
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_B[i,j] <- 1
}
else if(!condition){
portfolio_B[i,j] <- 0
}
else {
portfolio_B[i,j] <- NA
}
}
}
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_B[i,j] <- 1
}
else if(condition == FALSE){
portfolio_B[i,j] <- 0
}
else {
portfolio_B[i,j] <- NA
}
}
}
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition) && condition) {
portfolio_B[i,j] <- 1
}
else if(condition = FALSE){
portfolio_B[i,j] <- 0
}
else {
portfolio_B[i,j] <- NA
}
}
}
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
print(condition)
print(condition)
portfolio_B <- market_cap
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition)) {
if(condition) {
portfolio_B[i,j] <- 1
}
else {
portfolio_B[i,j] <- 0
}
}
}
}
portfolio_B <- market_cap
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition)) {
if(condition) {
portfolio_B[i,j] <- 1
}
else {
portfolio_B[i,j] <- 0
}
}
}
}
View(market_cap)
View(market_cap)
View(market_cap)
View(market_cap)
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition)) {
if(condition) {
portfolio_B[i,j] <- 1
}
else {
portfolio_B[i,j] <- 0
}
}
}
}
View(market_cap)
portfolio_B <- market_cap
for (i in 1:nrow(market_cap)) {
for(j in 1:ncol(market_cap)) {
condition <- market_cap[i,ncol(market_cap)] < market_cap[i,j]
if(!is.na(condition)) {
if(condition) {
portfolio_B[i,j] <- 1
}
else {
portfolio_B[i,j] <- 0
}
}
}
}
